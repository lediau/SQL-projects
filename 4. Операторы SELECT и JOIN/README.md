# Задание №4

В этой домашке речь пойдет про приют для бездомных животных Тетушки Мэйв. Вот уже несколько лет она помогает зверушкам, и не так давно их количество стало таким большим, что Тетушка уже не помнит обо всех звоих зверях. Именно для этого она обратилась к SQL-специалисту Ивану для создания базы данных, которая поможет ей в ее добром деле. Он их создал, оставил тетушке, и довольный уехал в Стамбул. Ваша задача - помочь Тетушке с ее делами, пользуясь базой данных Ивана.

База данных, кстати говоря, прикреплена ниже.

## Задание 1 (1 балл)

Так как у Тетушки Мэйв свой большой дом, то логично, что у нее есть коровы. А чтобы они не стояли без дела, Тетушка периодически доит их. А чтобы и ей было удобно, она поделила коров на группы (как - неважно). А теперь она хочет узнать, сколько в среднем она может собирать молока с этих групп.

Задание: Вам необходимо узнать среднее количество молока, которое можно получить с групп, в которых больше 3 коров.

Формат решения: Нужно написать скрипт, который по таблице

`create table Cow(
 name bigserial PRIMARY KEY,
 milk_per_second int, -- количество молока в миллилитрах
 breed int -- номер группы
);`

выведет все группы, в которых больше трех коров, а также среднее возможное количество молока в этих группах.

## Задание 2 (2 балла)

Дома у Тетушки Мэйв живет много животных, включая 100 собак. Поскольку со всеми она гулять не может, она решила сделать так: каждый день она отпускает собак на улицу каждое утро, а вечером ждет их дома. Но поскольку не каждая собака возвращается вовремя, ей хочется понимать, какой именно песик вернется попозже.

Задание: Есть таблица, заполненная номерами от 1 до 100, где одно из чисел пропущено. Необходимо как можно быстрее узнать, какого же номер не хватает, и вывести его.

Формат решения: Нужно представить скрипт, который выведет единственное число, которое отсутствует в таблице Dog.

`create table Dog(
 name bigserial primary key
);`

## Задание 3 (3 балла)

Главная задача Тетушки (но не единственная) - постараться найти хозяев для своих животных. Поскольку с рогатым скотом ситуация особая, она хочет в первую очередь разобраться с кошками. Один аналитик из компании По Коту на Семью сказал ей следующее: "Чтобы узнать спрос на кошку или кота, нужно применить формулу

sex∗breed3∗countage+(1−sex)∗breed2∗countagecountOfCats
где:

sex - пол (кошка=1, кот=0)

breed - порода (American=0.5, British=1, Munchkin=1.5, Siberian=2, Bengal=3)

count - количество цветов кошки

age - возраст кошки в месяцах

countOfCats - количество кошек и котов такой породы у Тетушки Мэйв

Все очень просто".

Задание: Ваша задача, как успешного SQL-специалиста, реализовать эту метрику для каждой кошки и отсортировать их по убыванию этой метрики.

Формат решения: Необходимо предоставить скрипт, который по таблице

`create table Cat(
 name text, -- имя
 age int, -- возраст в годах
 breed text, -- порода кошки
 sex int, -- пол кошки (F=1, M=0)
 count int -- количество цветов в окраске
);`
Выведет нужную таблицу со столбцами name:text, catGrade:float, отсортированную по убыванию catGrade. Обратите внимание, что breed задан в формате text.

## Задание 4 (4 балла)
Вернемся к рогатому скоту. У Тетушки есть целых 20 лошадей и коней (суммарно). Будем называть их всех просто лошади. У Тетушки есть целых 4 вида лошадей: Ездовые, Тяжеловесы, Скаковые и Пони. Каждому из этих видов она решила дать свой код длины 3. А тот же Аналитик посоветовал ей дать код и каждой лошади в следущем виде: xxx-aa, где xxx - это код ее вида, и aa - какойто суффикс, характеризующий ее номер.

Тетушка с детства мечатала разводить лошадей, и когда еще жто делать, если не сейчас? Поэтому она решила начать скрещивать лошадей и хочет узнать все возможные комбинации.

Однако у нее есть требования:

Скаковых лошадей можно скрещивать только со скаковыми

Тяжеловесов можно скрещивать с ездовыми только в случае, если они одного окраса

Ездовых можно скрещивать с пони только если разница в их росте не больше 20см.

Лошадей внутри одного типа можно скрещивать

При скрещивании разница в возрасте должна быть не больше 2 лет

Ну и конечно, их пол должен быть разным.

Задание: Ваша задача - вывести нужные комбинации.

Формат решения: Вам даны 2 таблицы

`create table Horse(
 name text,
 height int, -- рост лошади в сантиметрах
 code varchar(6) PRIMARY KEY, -- код лошади в формате xxx-aa
 color text, -- окрас лошади
 sex text, -- пол лошади в формате "male"/"female"
 age int -- возраст в годах
);`

`create table Horse_type(
 code varchar(3), -- код лошади в формате xxx
 name text -- тип лошади, один из `Ездовые`, `Тяжеловесы`, `Скаковые`, `Пони`
);`

Вам необходимо написать скрипт, который по этим двум таблицам выведет все возможные комбинации в формате name:text, name:text.
